<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>VerificaÃ§Ã£o de Escolas</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    :root {
      --bg-color: #f0f0f0;
      --text-color: #111;
      --container-bg: #fff;
      --table-header: #eee;
      --button-bg: #28a745;
    }
    body.dark-mode {
      --bg-color: #121212;
      --text-color: #f5f5f5;
      --container-bg: #1e1e1e;
      --table-header: #333;
      --button-bg: #2ecc71;
    }
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: var(--bg-color);
      color: var(--text-color);
      margin: 0;
      padding: 20px;
    }
    .container {
      background-color: var(--container-bg);
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      max-width: 700px;
      margin: auto;
    }
    h2 {
      text-align: center;
      margin-bottom: 20px;
    }
    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
    }
    input, select {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 6px;
      background-color: var(--container-bg);
      color: var(--text-color);
    }
    button {
      width: 100%;
      padding: 12px;
      margin-top: 15px;
      border: none;
      border-radius: 6px;
      background-color: var(--button-bg);
      color: white;
      font-size: 16px;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    button:hover {
      opacity: 0.9;
    }
    .toggle-mode {
      margin-top: 15px;
      text-align: center;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 40px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 10px;
      text-align: center;
    }
    th {
      background-color: var(--table-header);
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>FormulÃ¡rio de VerificaÃ§Ã£o das Escolas</h2>

    <label for="escola">Nome da Escola:</label>
    <input type="text" id="escola" placeholder="Digite o nome da escola" />

    <label for="sdwan">SD-WAN estÃ¡ ativo?</label>
    <select id="sdwan">
      <option value="Sim">Sim</option>
      <option value="NÃ£o">NÃ£o</option>
    </select>

    <label for="operadora">Operadora do Segundo Link (SD-WAN):</label>
    <input type="text" id="operadora" placeholder="Ex: Vivo, Claro, etc." />

    <label for="velocidade">Velocidade do Link (Mbps):</label>
    <input type="number" id="velocidade" placeholder="Ex: 100" />

    <label for="fotoRack">Foto do Rack:</label>
    <input type="file" id="fotoRack" accept="image/*" />

    <label for="precisaAPs">Necessita de APs?</label>
    <select id="precisaAPs" onchange="toggleQuantidadeAPs()">
      <option value="NÃ£o">NÃ£o</option>
      <option value="Sim">Sim</option>
    </select>

    <label for="quantidadeAPs">Quantidade de APs:</label>
    <input type="number" id="quantidadeAPs" min="0" value="0" />

    <button onclick="salvarEntrada()">ðŸ’¾ Salvar Entrada</button>
    <button onclick="exportarExcel()">ðŸ“¤ Exportar para Excel</button>

    <div class="toggle-mode">
      <button onclick="alternarModo()">ðŸŒ“ Alternar Modo Claro/Escuro</button>
    </div>
  </div>

  <table id="tabelaDados">
    <thead>
      <tr>
        <th>Escola</th>
        <th>SD-WAN</th>
        <th>Operadora</th>
        <th>Velocidade (Mbps)</th>
        <th>Foto do Rack</th>
        <th>Precisa de APs</th>
        <th>Qtd. APs</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const entradas = [];

    function toggleQuantidadeAPs() {
      const precisa = document.getElementById("precisaAPs").value;
      document.getElementById("quantidadeAPs").disabled = precisa === "NÃ£o";
      if (precisa === "NÃ£o") {
        document.getElementById("quantidadeAPs").value = 0;
      }
    }

    function salvarEntrada() {
      const escola = document.getElementById("escola").value;
      const sdwan = document.getElementById("sdwan").value;
      const operadora = document.getElementById("operadora").value;
      const velocidade = document.getElementById("velocidade").value;
      const precisaAPs = document.getElementById("precisaAPs").value;
      const quantidadeAPs = document.getElementById("quantidadeAPs").value;
      const fotoInput = document.getElementById("fotoRack");
      const fotoNome = fotoInput.files[0] ? fotoInput.files[0].name : "Sem foto";

      const novaEntrada = {
        escola,
        sdwan,
        operadora,
        velocidade,
        fotoRack: fotoNome,
        precisaAPs,
        quantidadeAPs
      };

      entradas.push(novaEntrada);
      adicionarNaTabela(novaEntrada);
      limparCampos();
    }

    function adicionarNaTabela(entrada) {
      const tabela = document.getElementById("tabelaDados").getElementsByTagName("tbody")[0];
      const novaLinha = tabela.insertRow();

      novaLinha.insertCell(0).innerText = entrada.escola;
      novaLinha.insertCell(1).innerText = entrada.sdwan;
      novaLinha.insertCell(2).innerText = entrada.operadora;
      novaLinha.insertCell(3).innerText = entrada.velocidade;
      novaLinha.insertCell(4).innerText = entrada.fotoRack;
      novaLinha.insertCell(5).innerText = entrada.precisaAPs;
      novaLinha.insertCell(6).innerText = entrada.quantidadeAPs;
    }

    function limparCampos() {
      document.getElementById("escola").value = "";
      document.getElementById("sdwan").value = "Sim";
      document.getElementById("operadora").value = "";
      document.getElementById("velocidade").value = "";
      document.getElementById("fotoRack").value = "";
      document.getElementById("precisaAPs").value = "NÃ£o";
      document.getElementById("quantidadeAPs").value = 0;
      document.getElementById("quantidadeAPs").disabled = true;
    }

    function exportarExcel() {
      const planilha = entradas.map(item => ({
        "Escola": item.escola,
        "SD-WAN": item.sdwan,
        "Operadora": item.operadora,
        "Velocidade (Mbps)": item.velocidade,
        "Foto do Rack": item.fotoRack,
        "Precisa de APs": item.precisaAPs,
        "Qtd. APs": item.quantidadeAPs
      }));

      const wb = XLSX.utils.book_new();
      const ws = XLSX.utils.json_to_sheet(planilha);
      XLSX.utils.book_append_sheet(wb, ws, "RelatÃ³rio Escolas");
      XLSX.writeFile(wb, "relatorio_escolas.xlsx");
    }

    function alternarModo() {
      document.body.classList.toggle("dark-mode");
    }
  </script>
</body>
</html>
